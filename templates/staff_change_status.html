{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
    <div class="card mx-auto shadow p-4" style="max-width: 900px;">
        <h2 class="text-center mb-4">Update Flight Status</h2>

        {% if is_operator is defined and is_operator %}
            <p class="text-center text-muted mb-4">
                Logged in as an Operator. You can update flight statuses
                {% if airline_name is defined %} for airline {{ airline_name }}{% endif %}.
            </p>
        {% endif %}

        <form method="post">
            <div class="mb-3">
                <label for="flight_num" class="form-label">Select a Flight</label>
                <select class="form-select" name="flight_key" id="flight_num" required>
                    {% if flights|length == 0 %}
                        <option value="" disabled selected>No future flights available</option>
                    {% else %}
                        {% for flight in flights %}
                        {# 
                           flight indices:
                           0: flight_num
                           1: departure_airport
                           2: arrival_airport
                           3: departure_time
                           4: arrival_time
                           5: status
                        #}
                        <option value="{{ flight[0] }}|{{ flight[3] }}">
                            Flight {{ flight[0] }} |
                            {{ flight[1] }} â†’ {{ flight[2] }} |
                            Departs: {{ flight[3] }} |
                            Status: {{ flight[5] }}
                        </option>
                        {% endfor %}
                    {% endif %}
                </select>
            </div>

            <div class="mb-3">
                <label for="new_status" class="form-label">New Status</label>
                <select class="form-select" name="new_status" id="new_status" required>
                    <option value="upcoming">Upcoming</option>
                    <option value="in progress">In Progress</option>
                    <option value="delayed">Delayed</option>
                    <option value="cancelled">Cancelled</option>
                    <option value="landed">Landed</option>
                </select>
            </div>

            <div class="d-grid">
                <button type="submit" class="btn btn-primary">Update Status</button>
            </div>
        </form>
    </div>

    <div class="mt-4 text-center">
        <a href="{{ url_for('staff_home') }}" class="btn btn-secondary">Back to Staff Home</a>
    </div>
</div>
{% endblock %}